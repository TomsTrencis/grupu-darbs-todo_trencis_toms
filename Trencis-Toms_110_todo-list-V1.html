<!-- 
Autors: Toms Trencis
Grupa: 110
Versija: 1
-->

<!-- Kas ir localStorage pārlūkprogrammā?
    ATB: localStorage ir īpašība, kas ļauj JavaScript vietnēm un lietotnēm saglabāt atslēgu-vērtību pārus tīmekļa pārlūkprogrammā bez derīguma termiņa.
    
    Atšķirībā no mainīgajiem (let vai const), kuru vērtības pazūd pēc lapas pārlādes (F5), localStorage saglabā datus pārlūkprogrammā bez derīguma termiņa un 
    tie nepazūd pat pēc lapas pārlādes, pārlūka aizvēršanas vai atkārtotas atvēršanas. 
-->
<!DOCTYPE html>
<html lang="lv">
<head>
    <meta charset="UTF-8">
    <title>Todo List V2</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container d-flex justify-content-center align-items-center min-vh-100">
    <div class="shadow p-4 bg-white rounded" style="width: 100%; max-width: 800px;">
        <h4 class="text-center mb-3">Todo List V2</h4>


        <div class="input-group mb-3">
            <select id="prioritySelect" class="form-select" style="max-width: 120px;">
                <option value="medium">Vidēja</option>
                <option value="low">Zema</option>
                <option value="high">Svarīgi</option>
            </select>

            <input id="taskInput" type="text" class="form-control" placeholder="Ieraksti darbu...">
            <button id="addButton" class="btn btn-primary">Pievienot</button>
        </div>
  <div class="btn-group" role="group" aria-label="Basic checkbox toggle button group">
  <input type="checkbox" class="btn-check" id="all" autocomplete="off">
  <label class="btn btn-outline-primary" for="all">Visi</label>

  <input type="checkbox" class="btn-check" id="active" autocomplete="off">
  <label class="btn btn-outline-primary" for="active">Aktīvie</label>

  <input type="checkbox" class="btn-check" id="finished" autocomplete="off">
  <label class="btn btn-outline-primary" for="finished">Pabeigtie</label>
</div>

        <ul id="taskList" class="list-group"></ul>
    </div>
</div>

<script>
const input = document.getElementById("taskInput");
const button = document.getElementById("addButton");
const list = document.getElementById("taskList");
const prioritySelect = document.getElementById("prioritySelect");


function saveTasks() {
    const tasks = [];

    document.querySelectorAll("#taskList li").forEach(li => {
        const text = li.querySelector(".task-text").textContent;
        const done = li.querySelector(".task-text")
            .classList.contains("text-decoration-line-through");
        const priority = li.dataset.priority;

        tasks.push({ text, done, priority });
    });

    localStorage.setItem("tasks", JSON.stringify(tasks));
}


function addTask(text, priority, done = false) {
    const li = document.createElement("li");
    li.className = "list-group-item d-flex justify-content-between align-items-center";
    li.dataset.priority = priority;


    const badge = document.createElement("span");
    badge.classList.add("badge", "me-2");

    if (priority === "high") {
        badge.textContent = "SVARĪGI";
        badge.classList.add("bg-danger");
    } else if (priority === "medium") {
        badge.textContent = "Vidēja";
        badge.classList.add("bg-warning");
    } else {
        badge.textContent = "Zema";
        badge.classList.add("bg-secondary");
    }


    const textSpan = document.createElement("span");
    textSpan.textContent = text;
    textSpan.className = "task-text flex-grow-1";
    textSpan.style.cursor = "pointer";

    if (done) {
        textSpan.classList.add("text-decoration-line-through");
    }

    textSpan.onclick = function () {
        textSpan.classList.toggle("text-decoration-line-through");
        saveTasks();
    };


    const left = document.createElement("div");
    left.className = "d-flex align-items-center gap-2";
    left.appendChild(badge);
    left.appendChild(textSpan);


    const deleteButton = document.createElement("button");
    deleteButton.className = "btn btn-outline-danger btn-sm";
    deleteButton.textContent = "Dzēst";

    deleteButton.onclick = function () {
        li.remove();
        saveTasks();
    };

    li.appendChild(left);
    li.appendChild(deleteButton);
    list.appendChild(li);

    saveTasks();
}


function loadTasks() {
    const tasks = JSON.parse(localStorage.getItem("tasks")) || [];
    tasks.forEach(task => addTask(task.text, task.priority, task.done));
}


button.onclick = function () {
    const text = input.value.trim();
    const priority = prioritySelect.value;
    if (text === "") return;

    addTask(text, priority);
    input.value = "";
};


input.addEventListener("keypress", function (e) {
    if (e.key === "Enter") {
        button.click();
    }
});

loadTasks();

    
</script>

</body>
</html>
